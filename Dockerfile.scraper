FROM python:3.10-slim

WORKDIR /app

# First, copy and install requirements to leverage Docker cache
COPY requirements-scraper.txt .
RUN pip install --no-cache-dir -r requirements-scraper.txt

# Now copy the source code
COPY src /app/src

# Create logs directory
RUN mkdir -p /app/logs && chmod 777 /app/logs

# Set Python path to recognize modules
ENV PYTHONPATH=/app/src:$PYTHONPATH

# Update CMD to use correct path
CMD ["python", "-u", "/app/src/ingestion/connectors/yahoo_connector.py"]